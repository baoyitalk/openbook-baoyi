

é—­åŒ…è®©å¼€å‘è€…å¯ä»¥ä»å†…éƒ¨å‡½æ•°è®¿é—®å¤–éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸ
å†…éƒ¨å‡½æ•°å¼•ç”¨äº†å¤–éƒ¨å‡½æ•°çš„å˜é‡ æ–¹æ³•
**é—­åŒ… = å¤–å±‚å‡½æ•° + è‡ªç”±å˜é‡ + å†…å±‚å‡½æ•°æŒæœ‰å¼•ç”¨**

![](images/1-ä»€ä¹ˆæ˜¯é—­åŒ…-20260122135626.png)

## å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘çš„ä¸‰ä¸ªåŸºæœ¬äº‹å®


### äº‹å®1ï¼š å‡½æ•°å¯ä»¥åµŒå¥—

```
function å¤–() {
    function å†…() { }
}

```

**å†…å±‚å‡½æ•°**


**å†…å±‚å‡½æ•° = å‡½æ•°é‡Œé¢å®šä¹‰çš„å‡½æ•°**

ä¸ç®¡å®ƒæ˜¯å¦è¢« returnï¼Œåªè¦**å®šä¹‰ä½ç½®**åœ¨å¦ä¸€ä¸ªå‡½æ•°å†…éƒ¨


è¯¯åŒº

```js
if (true) {
    function foo() {}  // è¿™ä¸æ˜¯"å†…å±‚å‡½æ•°"
}                      // å› ä¸º if ä¸æ˜¯å‡½æ•°


```

```
é—®è‡ªå·±ï¼šè¿™ä¸ªå‡½æ•°å†™åœ¨å“ªï¼Ÿ

å†™åœ¨å¦ä¸€ä¸ª function çš„ { } é‡Œ â†’ å†…å±‚å‡½æ•° âœ…
å†™åœ¨ if/for/å¯¹è±¡ çš„ { } é‡Œ    â†’ ä¸ç®— âŒ
å†™åœ¨æœ€å¤–å±‚                    â†’ å¤–å±‚å‡½æ•°


```




äº‹å®2ï¼šå†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å˜é‡
çœŸæ­£å¹²æ´»çš„å¯ä»¥è®¿é—®é—­åŒ…å‡½æ•°ä½œç”¨åŸŸçš„ç§æœ‰å˜é‡
```
function å¤–() {
    let a = 1;
    function å†…() {
        console.log(a);  // âœ… èƒ½è®¿é—®
    }
}

```


äº‹å®3: å‡½æ•°å¯ä»¥è¢«è¿”å›

```
function å¤–() {
    function å†…() { }
    return å†…;  // âœ… å‡½æ•°å½“è¿”å›å€¼
}

```


ç»„åˆä¸‰ä¸ªåŸºæœ¬äº‹å®

```
function å¤–() {
    let a = 1;
    function å†…() {
        console.log(a);
    }
    return å†…;
}

const fn = å¤–();  // å¤–() æ‰§è¡Œå®Œæ¯•
fn();             // â“ æ­¤æ—¶ a è¿˜åœ¨å—ï¼Ÿ

```


**å…³é”®é—®é¢˜**ï¼š

- æ­£å¸¸æƒ…å†µï¼šå‡½æ•°æ‰§è¡Œå®Œ â†’ å±€éƒ¨å˜é‡é”€æ¯
- ä½†Â `å†…`Â è¿˜åœ¨å¼•ç”¨Â `a`Â â†’ æ€ä¹ˆåŠï¼Ÿ

```
å¤–() æ‰§è¡Œå®Œæ¯•
    â†“
æ­£å¸¸åº”è¯¥é”€æ¯ a
    â†“
ä½† å†…() è¿˜å¼•ç”¨ç€ a
    â†“
æ‰€ä»¥ a è¢«ä¿ç•™ä¸‹æ¥ï¼Œè·Ÿç€ å†…() èµ°
    â†“
è¿™ä¸ªã€Œå‡½æ•° + å®ƒå¼•ç”¨çš„å¤–éƒ¨å˜é‡ã€çš„ç»„åˆ = é—­åŒ…

```


é—­åŒ…ä½¿ç”¨åœºæ™¯

![](images/1-ä»€ä¹ˆæ˜¯é—­åŒ…-20260122142828.png)

## æ¡ˆä¾‹1-ç»å…¸å¾ªç¯æ¡ˆä¾‹

ç”¨varå£°æ˜å˜é‡
```
for (var i = 1; i <= 3; i++) {
    setTimeout(function() {
        console.log(i);
    }, 1000);
}
// è¾“å‡ºï¼š4, 4, 4

```

æ‹†è§£æ‰§è¡Œé¡ºåº
```
// ç¬¬1æ¬¡å¾ªç¯ (i=1)
setTimeout(function() { console.log(i); }, 1000);  // å‡½æ•°1

// ç¬¬2æ¬¡å¾ªç¯ (i=2)
setTimeout(function() { console.log(i); }, 1000);  // å‡½æ•°2

// ç¬¬3æ¬¡å¾ªç¯ (i=3)
setTimeout(function() { console.log(i); }, 1000);  // å‡½æ•°3

// å¾ªç¯ç»“æŸå i=4
// å¾ªç¯ç»“æŸ å‡½æ•°æ‰å¼€å§‹æ‰§è¡Œ æ¬¡æ•°varä¿®é¥°æ˜¯å…¨å±€ä½œç”¨äºiå…±äº«ï¼Œå‡½æ•°æ˜¯å®šä¹‰äº†ä½†æ²¡æ‰§è¡Œ



```

![](images/1-ä»€ä¹ˆæ˜¯é—­åŒ…-20260122134848.png)


### è§£å†³æ–¹æ¡ˆ1-ç”¨letå£°æ˜å˜é‡ å—çº§ä½œç”¨åŸŸ



```
for (let i = 1; i <= 3; i++) {
    setTimeout(function() {
        console.log(i);
    }, 1000);
}
// è¾“å‡º: 1, 2, 3


```

```
        var                              let
        â”€â”€â”€                              â”€â”€â”€
        
æ—¶é—´0ms  â”Œâ”€ å¾ªç¯å¼€å§‹ â”€â”                  â”Œâ”€ å¾ªç¯å¼€å§‹ â”€â”
        â”‚ i=1 åˆ›å»ºå‡½æ•°1â”‚                  â”‚ i=1 åˆ›å»ºå‡½æ•°1ï¼ˆç»‘å®ši=1ï¼‰
        â”‚ i=2 åˆ›å»ºå‡½æ•°2â”‚                  â”‚ i=2 åˆ›å»ºå‡½æ•°2ï¼ˆç»‘å®ši=2ï¼‰
        â”‚ i=3 åˆ›å»ºå‡½æ•°3â”‚                  â”‚ i=3 åˆ›å»ºå‡½æ•°3ï¼ˆç»‘å®ši=3ï¼‰
        â”‚ i=4 å¾ªç¯ç»“æŸ â”‚                  â”‚ å¾ªç¯ç»“æŸ
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        
æ—¶é—´1000ms  å‡½æ•°æ‰§è¡Œ                       å‡½æ•°æ‰§è¡Œ
           â”‚                              â”‚
           â†“                              â†“
        æ‰¾ i â†’ 4                       å„è‡ªæ‰¾è‡ªå·±çš„ i
        æ‰¾ i â†’ 4                       å‡½æ•°1 â†’ 1
        æ‰¾ i â†’ 4                       å‡½æ•°2 â†’ 2
                                       å‡½æ•°3 â†’ 3


```



### è§£å†³æ–¹æ¡ˆ2-é—­åŒ… åˆ›å»ºæ–°ä½œç”¨åŸŸä¿æŒå˜é‡ç‹¬ç«‹

```
for (var i = 1; i <= 3; i++) {
    (function(j) {  // åˆ›å»ºæ–°ä½œç”¨åŸŸï¼Œj æ˜¯ç‹¬ç«‹çš„
        setTimeout(function() {
            console.log(j);
        }, 1000);
    })(i);
}
// è¾“å‡ºï¼š1, 2, 3


```



## é—­åŒ…çš„æ ¸å¿ƒä½œç”¨

ç§æœ‰å˜é‡

```js
function createWallet() {
    let money = 100;  // å¤–éƒ¨æ— æ³•ç›´æ¥è®¿é—®
    
    return {
        spend: function(amount) {
            if (amount <= money) {
                money -= amount;
                return true;
            }
            return false;
        },
        check: function() {
            return money;
        }
    };
}

const wallet = createWallet();
wallet.check();     // 100
wallet.spend(30);   // true
wallet.check();     // 70
wallet.money;       // undefined â† è®¿é—®ä¸åˆ°ï¼

```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  createWallet ä½œç”¨åŸŸ         â”‚
â”‚                             â”‚
â”‚   money = 70  ğŸ”’ ç§æœ‰çš„      â”‚
â”‚       â†‘                     â”‚
â”‚   â”Œâ”€â”€â”€â”´â”€â”€â”€â”                 â”‚
â”‚   â”‚ spend â”‚ â† èƒ½è®¿é—® money   â”‚
â”‚   â”‚ check â”‚ â† èƒ½è®¿é—® money   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ è¿”å›
    å¤–éƒ¨åªèƒ½ç”¨ spend/check
    ä¸èƒ½ç›´æ¥æ”¹ money
    
    
let æ›¿ä»£ä¸äº†ï¼šlet åªæ˜¯å—ä½œç”¨åŸŸï¼Œæ— æ³•å®ç°"ç§æœ‰"

```


 ### ç§æœ‰å˜é‡ï¼ˆé—­åŒ…ï¼‰ è·Ÿå—çº§ä½œç”¨åŸŸæ ¸å¿ƒåŒºåˆ«
![](images/1-ä»€ä¹ˆæ˜¯é—­åŒ…-20260122140620.png)
å—çº§ä½œç”¨åŸŸ
```js
{
  let money = 70;
  console.log(money); // âœ… 70
}
console.log(money); // âŒ æŠ¥é”™ï¼Œmoney ä¸å­˜åœ¨äº†
// å—ç»“æŸï¼Œmoney å°±"æ­»äº†"ï¼Œè°ä¹Ÿç”¨ä¸äº†

```

ç§æœ‰ï¼ˆé—­åŒ…ï¼‰
```js
// å–é’±æ¶ˆè´¹è¿™ä¸ªæ¡ˆä¾‹å°±å¾ˆç»å…¸
function createWallet() {
  let money = 70;  // ç§æœ‰å˜é‡
  
  return {
    spend(n) { money -= n; },
    check() { return money; }
  };
}

const wallet = createWallet();
wallet.check();    // âœ… 70 â€”â€” é€šè¿‡æ–¹æ³•è®¿é—®
wallet.money;      // âŒ undefined
// money è¿˜"æ´»ç€"ï¼Œä½†åªèƒ½é€šè¿‡ spend/check æ“ä½œ


```
**å—çº§ä½œç”¨åŸŸ** = å˜é‡çš„"å¯¿å‘½"çŸ­ï¼Œå—ç»“æŸå°±æ²¡äº†

**ç§æœ‰** = å˜é‡è¿˜æ´»ç€ï¼Œä½†å¤–éƒ¨**åªèƒ½é€šè¿‡ä½ æä¾›çš„æ–¹æ³•**æ¥æ“ä½œ














## å‡½æ•°å·¥å‚


```
å¤–å±‚å‡½æ•°ï¼šæ¥æ”¶"é…ç½®"ï¼ˆx=å‡ å€ï¼‰
å†…å±‚å‡½æ•°ï¼šæ¥æ”¶"æ•°æ®"ï¼ˆy=è¦ä¹˜çš„æ•°ï¼‰

è°ƒç”¨å¤–å±‚ â†’ æ‹¿åˆ°å†…å±‚
è°ƒç”¨å†…å±‚ â†’ æ‹¿åˆ°ç»“æœ

function å·¥å‚(é…ç½®å‚æ•°) {
  return function(åŸæ–™) {
    // ç”¨ é…ç½®å‚æ•° + åŸæ–™ ç”Ÿäº§ç»“æœ
    return ç»“æœ;
  };
}

const æœºå™¨A = å·¥å‚(é…ç½®A);
const æœºå™¨B = å·¥å‚(é…ç½®B);

æœºå™¨A(åŸæ–™1);  // ç”¨é…ç½®AåŠ å·¥åŸæ–™1
æœºå™¨B(åŸæ–™2);  // ç”¨é…ç½®BåŠ å·¥åŸæ–™2




```

æ¡ˆä¾‹ï¼š
```js
// ç”Ÿæˆä¸åŒæŠ˜æ‰£è®¡ç®—å™¨
function createDiscount(rate) {
  return function(price) {
    return price * rate;
  };
}

const å…«æŠ˜ = createDiscount(0.8);
const åŠä»· = createDiscount(0.5);

å…«æŠ˜(100);  // 80
åŠä»·(100);  // 50

```


é—­åŒ…å­˜åœ¨çš„å¿…è¦æ€§

å‡½æ•°å·¥å‚ä¸ºä¾‹

éœ€æ±‚åœºæ™¯æ˜¯ä¸€å¥—é…ç½® ç”¨å˜é‡è¶³å¤Ÿ
```
// æ–¹æ¡ˆAï¼šç›´æ¥ç”¨å˜é‡
const taxRate = 0.08;
function calcTax(price) {
  return price * (1 + taxRate);
}

calcTax(100);  // 108

```


éœ€è¦å¤šå¥—é…ç½®åŒæ—¶å­˜åœ¨æ—¶å€™

å˜é‡æ–¹å¼çš„é—®é¢˜
```js
let taxRate = 0.08;

function calcTax(price) {
  return price * (1 + taxRate);
}

// ç¾å›½è®¢å•
taxRate = 0.08;
const ç¾å›½ä»· = calcTax(100);  // 108

// æ¬§æ´²è®¢å•
taxRate = 0.20;
const æ¬§æ´²ä»· = calcTax(100);  // 120

// âš ï¸ é—®é¢˜æ¥äº†ï¼ä¹‹å‰çš„ç¾å›½ç¨ç‡è¢«è¦†ç›–äº†
// å¦‚æœå†ç®—ç¾å›½è®¢å•ï¼Œå¾—é‡æ–°è®¾ç½® taxRate

```


é—­åŒ…æ–¹å¼

```js
function createTaxCalc(taxRate) {
  return function(price) {
    return price * (1 + taxRate);
  };
}

const ç¾å›½ç¨ = createTaxCalc(0.08);
const æ¬§æ´²ç¨ = createTaxCalc(0.20);
const æ—¥æœ¬ç¨ = createTaxCalc(0.10);

// ä¸‰å¥—é…ç½®åŒæ—¶å­˜åœ¨ï¼Œäº’ä¸å¹²æ‰°
ç¾å›½ç¨(100);  // 108
æ¬§æ´²ç¨(100);  // 120
æ—¥æœ¬ç¨(100);  // 110

// éšæ—¶å¯ç”¨ï¼Œä¸ç”¨åˆ‡æ¢
ç¾å›½ç¨(200);  // 216

```
ä¸€å¥è¯æ€»ç»“

|åœºæ™¯|ç”¨ä»€ä¹ˆ|
|---|---|
|åªéœ€è¦**ä¸€å¥—é…ç½®**|æ™®é€šå˜é‡å°±å¤Ÿ|
|éœ€è¦**å¤šå¥—é…ç½®å¹¶å­˜**|é—­åŒ…æ›´åˆé€‚|


## å‡½æ•°æŸ¯é‡ŒåŒ–

**æŸ¯é‡ŒåŒ– = æŠŠä¸€æ¬¡åƒå®Œçš„é¥­ï¼Œå˜æˆä¸€å£ä¸€å£åƒ**

æ¡ˆä¾‹1ï¼š
```js
// æ™®é€šå†™æ³•
function add(a, b, c) {
    return a + b + c;
}
add(1, 2, 3);  // 6

// æŸ¯é‡ŒåŒ–ï¼ˆé—­åŒ…å®ç°ï¼‰
function curriedAdd(a) {
    return function(b) {
        return function(c) {
            return a + b + c;  // è®°ä½äº† a å’Œ b
        };
    };
}
curriedAdd(1)(2)(3);  // 6

// å®ç”¨åœºæ™¯
const addTax = curriedAdd(0.1);  // å›ºå®šç¨ç‡ 10%
const addShipping = addTax(5);    // å›ºå®šè¿è´¹ 5
addShipping(100);  // 0.1 + 5 + 100 = 105.1


```
æ¡ˆä¾‹2ï¼š

```js
// å‡è®¾è¦å®ç°ï¼šè¿‡æ»¤ â†’ æ˜ å°„ â†’ æ’åº

// ===== å·¥å‚æ¨¡å¼æ€ç»´ =====
const createProcessor = (filterFn, mapFn, sortFn) => {
    return (data) => {
        return data.filter(filterFn).map(mapFn).sort(sortFn);
    };
};
// é—®é¢˜ï¼šfilterFn, mapFn, sortFn å¿…é¡»åŒæ—¶ä¼ å…¥
// æ— æ³•çµæ´»ç»„åˆ

// ===== æŸ¯é‡ŒåŒ–æ€ç»´ =====
const filter = fn => arr => arr.filter(fn);
const map = fn => arr => arr.map(fn);
const sort = fn => arr => [...arr].sort(fn);

const pipe = (...fns) => x => fns.reduce((v, f) => f(v), x);

// å¯ä»¥ä»»æ„ç»„åˆ
const process1 = pipe(filter(x => x > 0), map(x => x * 2));
const process2 = pipe(map(x => x * 2), sort((a, b) => a - b));
const process3 = pipe(filter(x => x > 0), sort((a, b) => b - a));

// çµæ´»åº¦å®Œå…¨ä¸åŒ


```
å·¥å‚æ¨¡å¼å¯¹æ¯” æŸ¯é‡ŒåŒ–


```
å·¥å‚æ¨¡å¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         createProcessor(è¿‡æ»¤, æ˜ å°„, æ’åº)      â”‚
â”‚                                             â”‚
â”‚    å¿…é¡»åŒæ—¶å¡è¿›å» 3 ä¸ªå‡½æ•°ï¼Œç¼ºä¸€ä¸å¯            â”‚
â”‚                                             â”‚
â”‚         ğŸ“¦ â† [filterFn, mapFn, sortFn]      â”‚
â”‚                                             â”‚
â”‚    æƒ³è¦ä¸åŒç»„åˆï¼Ÿé‡æ–°å»ºä¸€ä¸ªå·¥å‚ï¼               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ˜« æƒ³è¦ åªè¿‡æ»¤+æ˜ å°„ï¼Ÿ â†’ ä¸è¡Œï¼Œå¿…é¡»ä¼ 3ä¸ª
ğŸ˜« æƒ³è¦ åªæ˜ å°„+æ’åºï¼Ÿ â†’ ä¸è¡Œï¼Œå¿…é¡»ä¼ 3ä¸ª


æŸ¯ç†åŒ–
æ¯ä¸ªæ“ä½œéƒ½æ˜¯ç‹¬ç«‹ç§¯æœ¨ï¼š

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ filter  â”‚    â”‚   map   â”‚    â”‚  sort   â”‚
   â”‚  è¿‡æ»¤   â”‚    â”‚   æ˜ å°„   â”‚    â”‚  æ’åº   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        ğŸŸ¦            ğŸŸ¨             ğŸŸ©


æƒ³æ€ä¹ˆæ‹¼å°±æ€ä¹ˆæ‹¼ï¼š

ç»„åˆ1:  ğŸŸ¦ â†’ ğŸŸ¨           è¿‡æ»¤ â†’ æ˜ å°„
ç»„åˆ2:  ğŸŸ¨ â†’ ğŸŸ©           æ˜ å°„ â†’ æ’åº  
ç»„åˆ3:  ğŸŸ¦ â†’ ğŸŸ©           è¿‡æ»¤ â†’ æ’åº
ç»„åˆ4:  ğŸŸ¦ â†’ ğŸŸ¨ â†’ ğŸŸ©      å…¨éƒ¨éƒ½è¦
ç»„åˆ5:  ğŸŸ© â†’ ğŸŸ¦ â†’ ğŸŸ¨      æ¢ä¸ªé¡ºåºä¹Ÿè¡Œï¼


```

| æ¨¡å¼  | æ¯”å–»        | çµæ´»åº¦   |
| --- | --------- | ----- |
| å·¥å‚  | å¥—é¤ï¼ˆå¿…é¡»ä¸€èµ·ä¹°ï¼‰ | â­     |
| æŸ¯é‡ŒåŒ– | å•ç‚¹ï¼ˆéšæ„æ­é…ï¼‰  | â­â­â­â­â­ |




## ç¼“å­˜å˜é‡çš„å€¼


ç¼“å­˜ = ç§æœ‰å˜é‡ + å‡½æ•°å·¥å‚


ç§æœ‰å˜é‡ + å‡½æ•°å·¥å‚ = åŸºç¡€ç§¯æœ¨

ç¼“å­˜(memoize)    â† ç”¨ç§¯æœ¨æ­çš„"å¸¸ç”¨æ¨¡å‹"ï¼Œç»™å®ƒèµ·ä¸ªå
é˜²æŠ–(debounce)   â† ç”¨ç§¯æœ¨æ­çš„"å¸¸ç”¨æ¨¡å‹"ï¼Œç»™å®ƒèµ·ä¸ªå
èŠ‚æµ(throttle)   â† ç”¨ç§¯æœ¨æ­çš„"å¸¸ç”¨æ¨¡å‹"ï¼Œç»™å®ƒèµ·ä¸ªå
æŸ¯é‡ŒåŒ–(curry)    â† ç”¨ç§¯æœ¨æ­çš„"å¸¸ç”¨æ¨¡å‹"ï¼Œç»™å®ƒèµ·ä¸ªå


åªè¦å˜é‡åœ¨å‡½æ•°å†…éƒ¨ï¼ˆä¸ç®¡æ˜¯å½¢å‚è¿˜æ˜¯è‡ªå·±å£°æ˜çš„ï¼‰ï¼Œå¤–éƒ¨æ‹¿ä¸åˆ°ï¼Œå°±æ˜¯ç§æœ‰ï¼›é—­åŒ…å°±æ˜¯è®©è¿™äº›ç§æœ‰å˜é‡ä¸é”€æ¯ï¼Œè¿˜èƒ½é€šè¿‡è¿”å›çš„å‡½æ•°é—´æ¥æ“ä½œ

### æ¡ˆä¾‹1

```js
  

function createInc(startValue) {

let index = -1;

return (step) => {

startValue += step;

index++;

return [index, startValue];

};

}

  

const inc = createInc(5);

console.log(inc(2)); // [0, 7]

console.log(inc(2)); // [1, 9]

console.log(inc(2)); // [2, 11]

```
æ‹†è§£1 
å‡½æ•°ä½œç”¨åŸŸå˜é‡
startValueä¹Ÿæ˜¯ å‡½æ•°ä½œç”¨åŸŸçš„ç§æœ‰å˜é‡
```js
function createInc(initValue) { // å½¢å‚æ”¹ä¸ªåå­—

let startValue = initValue; // ç”¨letå£°æ˜ï¼ŒæŠŠå½¢å‚å­˜è¿›å»

let index = -1;

return (step) => {

startValue += step;

index++;

return [index, startValue];

};

}

  

const inc = createInc(5);

// å¤–éƒ¨ä¾ç„¶è®¿é—®ä¸åˆ° startValue/index â†’ è¿˜æ˜¯ç§æœ‰

```

æœ¬è´¨ï¼šä¸ç®¡æ˜¯ â€œå½¢å‚ç›´æ¥ç”¨â€ è¿˜æ˜¯ â€œlet å£°æ˜å­˜å½¢å‚â€ï¼Œåªè¦åœ¨ `createInc` ä½œç”¨åŸŸå†…ï¼Œå°±æ˜¯ç§æœ‰çš„ï¼›é—­åŒ…ä¿æŠ¤çš„æ˜¯ã€Œæ•´ä¸ªä½œç”¨åŸŸçš„å˜é‡ã€ï¼Œä¸æ˜¯æŸä¸€ç§å£°æ˜æ–¹å¼çš„å˜é‡ã€‚

**é¢å¤–è¡¥å……ï¼švar å£°æ˜ä¹Ÿä¸ä¼šç ´åç§æœ‰æ€§ï¼ˆåªæ˜¯æå‡è§„åˆ™ä¸åŒï¼‰ï¼Œä¼šè¢«å‡½æ•°ä½œç”¨åŸŸé™åˆ¶**

å°±ç®—ä½ åœ¨ `createInc` é‡Œç”¨ var å£°æ˜å˜é‡ï¼Œä¾ç„¶æ˜¯ç§æœ‰çš„ï¼Œå¤–éƒ¨è®¿é—®ä¸åˆ°ï¼š




### æ¡ˆä¾‹2
```js
function memoize(fn) {

const cache = {}

  

return function(n) {

if(cache[n] !== undefined) {

console.log('ä»ç¼“å­˜ä¸­å–')

return cache[n];

}

console.log('è®¡ç®—ä¸­...');

cache[n] = fn(n);

return cache[n]

}

}

const factorial = memoize(function(n) {

return n <= 1 ? 1 : n * factorial(n-1);

})

factorial(5); // è®¡ç®—ä¸­... 120

factorial(5); // ä»ç¼“å­˜å– 120
```


æ‹†è§£æ¡ˆä¾‹1

### å¯¹è±¡ ä¸æ•°ç»„å¯¹æ¯”

| ç‰¹æ€§          | æ•°ç»„ `[]`             | å¯¹è±¡ `{}`  |
| ----------- | ------------------- | -------- |
| é”®ç±»å‹         | åªèƒ½æ˜¯è¿ç»­æ•°å­—ç´¢å¼•           | ä»»æ„å­—ç¬¦ä¸²/æ•°å­— |
| æœ‰ `.length` | âœ… æœ‰                 | âŒ æ²¡æœ‰     |
| æœ‰æ•°ç»„æ–¹æ³•       | âœ… `push/map/filter` | âŒ æ²¡æœ‰     |

```js
// æ•°ç»„ï¼šè¿ç»­ç´¢å¼•
const arr = [];
arr[0] = 'a';
arr[1] = 'b';
arr.length  // â†’ 2

// å¯¹è±¡ï¼šéšæ„è·³è·ƒ
const obj = {};
obj[100] = 'a';
obj[999] = 'b';
obj.length  // â†’ undefined

```



cache[n] æ˜¯ä»€ä¹ˆ
è¿™æ˜¯JavaScriptå¯¹è±¡çš„ä¸¤ç§è®¿é—®æ–¹å¼

```js
const cache = {};

// æ–¹å¼1ï¼šç‚¹è¯­æ³•ï¼ˆå±æ€§åæ˜¯å›ºå®šçš„ï¼‰
cache.name = "å¼ ä¸‰";
cache.age = 25;

// æ–¹å¼2ï¼šæ–¹æ‹¬å·è¯­æ³•ï¼ˆå±æ€§åå¯ä»¥æ˜¯å˜é‡ï¼‰
const key = "name";
cache[key] = "å¼ ä¸‰";     // ç­‰åŒäº cache.name = "å¼ ä¸‰"
cache["age"] = 25;       // ç­‰åŒäº cache.age = 25


```


ä¸ºä»€ä¹ˆç”¨cache[n] è€Œä¸æ˜¯cache.n ?

ç”¨å˜é‡çš„å€¼ä½œä¸ºé”® è€Œä¸æ˜¯ å˜é‡åä½œä¸ºé”®å€¼
```js
// ä½¿ç”¨cache[n]
function memoize(fn) {
    const cache = {}; // é—­åŒ…å¯¹è±¡æ¥ç¼“å­˜ å¯¹æ¯”ä¸æ•°ç»„åŒºåˆ«
    return function(n) {    // n æ˜¯å˜é‡ï¼Œå€¼ä¼šå˜åŒ–ï¼
        cache[n] = fn(n);   // ç”¨ n çš„å€¼ä½œä¸ºå±æ€§å
        return cache[n];
    };
}

const factorial = memoize(fn);

factorial(3);  // n = 3  â†’ cache[3] = 6   â†’ cache = { 3: 6 }
factorial(5);  // n = 5  â†’ cache[5] = 120 â†’ cache = { 3: 6, 5: 120 }
factorial(3);  // n = 3  â†’ cache[3] å·²å­˜åœ¨ï¼Œç›´æ¥è¿”å› 6


```

å¦‚æœç”¨cache.n:
```js

cache.n = fn(n);  // âŒ è¿™ä¼šåˆ›å»ºä¸€ä¸ªå« "n" çš„å±æ€§
                  // cache = { n: 6 }ï¼Œæ°¸è¿œåªæœ‰ä¸€ä¸ªé”®


```

|å†™æ³•|å«ä¹‰|ç»“æœ|
|---|---|---|
|`cache.n`|è®¿é—®åä¸º `"n"` çš„å±æ€§|`cache = { n: å€¼ }`|
|`cache[n]`|è®¿é—®åä¸º **nå˜é‡çš„å€¼** çš„å±æ€§|`cache = { 3: å€¼, 5: å€¼, ... }`|



æ‹†è§£2 

é«˜é˜¶å‡½æ•°ä¸å‡½æ•°å·¥å‚
```
            é«˜é˜¶å‡½æ•°                    å‡½æ•°å·¥å‚
           (æ˜¯ä»€ä¹ˆ)                    (åšä»€ä¹ˆ)
              â”‚                           â”‚
              â–¼                           â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  æ¥æ”¶å‡½æ•° æˆ–    â”‚          â”‚   æ‰¹é‡ç”Ÿäº§      â”‚
     â”‚  è¿”å›å‡½æ•°       â”‚          â”‚   å®šåˆ¶åŒ–å‡½æ•°    â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                           â”‚
              â–¼                           â–¼
           æŠ€æœ¯ç‰¹å¾                     ä½¿ç”¨ç›®çš„


```

1. **åŒ…å«å…³ç³»**ï¼šå‡½æ•°å·¥å‚ä¸€å®šæ˜¯é«˜é˜¶å‡½æ•°ï¼Œä½†é«˜é˜¶å‡½æ•°ä¸ä¸€å®šæ˜¯å‡½æ•°å·¥å‚ï¼›
2. **æ ¸å¿ƒåŒºåˆ†**ï¼šçœ‹ç›®çš„ â€”â€” å¦‚æœé«˜é˜¶å‡½æ•°çš„æ ¸å¿ƒæ˜¯ â€œé€ å®šåˆ¶åŒ–å‡½æ•°â€ï¼Œå°±æ˜¯å‡½æ•°å·¥å‚ï¼›å¦‚æœæ˜¯å…¶ä»–ç›®çš„ï¼ˆéå†ã€é˜²æŠ–ã€è¿‡æ»¤ï¼‰ï¼Œå°±æ˜¯æ™®é€šé«˜é˜¶å‡½æ•°ï¼›
3. **è®°å¿†å…³é”®ç‚¹**ï¼šé«˜é˜¶å‡½æ•°æ˜¯ â€œæ“ä½œå‡½æ•°çš„å‡½æ•°â€ï¼ˆæ”¶å‡½æ•° / è¿”å‡½æ•°ï¼‰ï¼Œå‡½æ•°å·¥å‚æ˜¯ â€œä¸“é—¨é€ å‡½æ•°çš„é«˜é˜¶å‡½æ•°â€ã€‚

åªè¦è¿”å›å‡½æ•°ï¼Œå°±æ˜¯å‡½æ•°å·¥å‚ï¼Œè¾“å…¥æ˜¯ä»€ä¹ˆä¸é‡è¦ï¼Œå…³é”®çœ‹è¾“å‡ºæ˜¯ä¸æ˜¯æ–°å‡½æ•°



æ‹†è§£3
é˜¶ä¹˜å‡½æ•°

- **å•è¯æ ¹æº**ï¼š`factorial` æ¥è‡ªæ•°å­¦æœ¯è¯­ï¼Œæ ¸å¿ƒæ˜¯ â€œé˜¶ä¹˜â€ï¼›è€Œ â€œå‡½æ•°å·¥å‚â€ çš„è‹±æ–‡æ˜¯ `function factory`ï¼Œæ˜¯ç¼–ç¨‹é‡Œç”Ÿæˆå‡½æ•°çš„å‡½æ•°ï¼Œä¸¤è€…æ‹¼å†™ / å«ä¹‰å®Œå…¨ä¸åŒã€‚
- **ä»£ç é€»è¾‘å†è§£é‡Š**ï¼šä½ è¿™æ®µä»£ç æ˜¯è®¡ç®—æ•°å­—çš„é˜¶ä¹˜ï¼ˆ`n!`ï¼‰ï¼Œæ¯”å¦‚ `factorial(5)` å°±æ˜¯è®¡ç®— `5Ã—4Ã—3Ã—2Ã—1=120`ï¼š
- ![](images/1-ä»€ä¹ˆæ˜¯é—­åŒ…-20260124105139.png)




## é˜²æŠ–èŠ‚æµ


### æ¡ˆä¾‹1
```js
function debounce(fn, delay) {
    let timer = null;  // é—­åŒ…ä¿å­˜ timer
    
    return function(...args) {
        clearTimeout(timer);
        timer = setTimeout(() => {
            fn.apply(this, args);
        }, delay);
    };
}

// ä½¿ç”¨
const search = debounce(function(keyword) {
    console.log('æœç´¢:', keyword);
}, 500);

// å¿«é€Ÿè¾“å…¥ï¼Œåªæ‰§è¡Œæœ€åä¸€æ¬¡
search('a');
search('ab');
search('abc');  // åªæœ‰è¿™ä¸ªä¼šæ‰§è¡Œ

```


æ‹†è§£1
```js
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  debounce ä½œç”¨åŸŸ          â”‚
â”‚                          â”‚
â”‚   timer = ... ğŸ”’         â”‚
â”‚      â†‘                   â”‚
â”‚   è¿”å›çš„å‡½æ•°èƒ½è®¿é—® timer   â”‚
â”‚   æ¯æ¬¡è°ƒç”¨å…±äº«åŒä¸€ä¸ª timer â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


```

## æ¨¡å—æ¨¡å¼
é—­åŒ…æ¨¡æ‹Ÿç§æœ‰æ–¹æ³•
ç§æœ‰æ–¹æ³•å¯ä»¥é™åˆ¶å¯¹ä»£ç çš„è®¿é—®ï¼Œ è€Œä¸”å¯ä»¥ç”¨äºç®¡ç†å…¨å±€å˜é‡å‘½åï¼Œé¿å…æ‰°ä¹±å…¬å…±ä»£ç 

### æ¡ˆä¾‹1

```js
  

let Counter = (function() {

let privateCounter = 0;

function changeBy(val) {

privateCounter += val;

}

return {

increment: function() {

changeBy(1);

},

decrement: function() {

changeBy(-1);

},

value: function() {

return privateCounter;

}

};

})();

  

console.log(Counter.value()); // 0

Counter.increment();

Counter.increment();

console.log(Counter.value()); // 2

Counter.decrement();

console.log(Counter.value()); // 1

```

**æ‹†è§£ï¼ˆé—­åŒ…çš„å…³é”®ç—•è¿¹ï¼‰**

1. ä»£ç é‡Œçš„é—­åŒ…ä½“ç°åœ¨ï¼š`increment/decrement/value` è¿™ä¸‰ä¸ªå†…éƒ¨å‡½æ•°ï¼Œ**å¼•ç”¨äº†å¤–éƒ¨å‡½æ•°é‡Œçš„ `changeBy` å’Œ `privateCounter`**ï¼›
2. ç«‹å³æ‰§è¡Œå‡½æ•°æ‰§è¡Œå®Œåï¼Œ`privateCounter` æ²¡æœ‰è¢«é”€æ¯ï¼Œä¾ç„¶èƒ½è¢«è¿™ä¸‰ä¸ªå†…éƒ¨å‡½æ•°æ“ä½œ / è®¿é—® â€”â€” è¿™å°±æ˜¯é—­åŒ…æœ€æ ¸å¿ƒçš„ä½“ç°ï¼›
3. ç®€å•è®°ï¼šåªè¦ã€Œå†…éƒ¨å‡½æ•°ç”¨äº†å¤–éƒ¨çš„å˜é‡ï¼Œä¸”å¤–éƒ¨å‡½æ•°æ‰§è¡Œå®Œå˜é‡è¿˜åœ¨ã€ï¼Œå°±æ˜¯é—­åŒ…ã€‚

è¿™æ®µä»£ç æ˜¯é—­åŒ…çš„ç»å…¸åº”ç”¨ï¼ˆæ¨¡å—æ¨¡å¼ï¼‰ï¼Œæ ¸å¿ƒå°±æ˜¯ç”¨é—­åŒ…å®ç° â€œç§æœ‰å˜é‡ + çŠ¶æ€æŒä¹…åŒ–â€ï¼Œä½ ç›¯ç€ã€Œå†…éƒ¨å‡½æ•°å¼•ç”¨å¤–éƒ¨å˜é‡ã€è¿™ä¸ªç‚¹ï¼Œå°±èƒ½å¿«é€Ÿè¯†åˆ«æ‰€æœ‰é—­åŒ…ä»£ç ï½



### æ¡ˆä¾‹2

```js
const Calculator = (function() {
    // ç§æœ‰
    let result = 0;
    
    function validate(n) {
        return typeof n === 'number';
    }
    
    // å…¬å¼€
    return {
        add: function(n) {
            if (validate(n)) result += n;
            return this;
        },
        getResult: function() {
            return result;
        }
    };
})();

Calculator.add(5).add(3).getResult();  // 8
Calculator.result;    // undefined
Calculator.validate;  // undefined


```
æ‹†è§£ å‡½æ•°å¢™
å¢™å†…+returnæ‰€æœ‰å‡½æ•°è¡¨è¾¾å¼å…·å¤‡ï¼Œé—­åŒ…è¦æ»¡è¶³ å†…éƒ¨å‡½æ•°å¼•ç”¨å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸçš„å˜é‡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IIFE çš„ä½œç”¨åŸŸï¼ˆå¢™å†…ï¼‰           â”‚
â”‚                                 â”‚
â”‚   let result = 0     ğŸ”’ç§æœ‰     â”‚
â”‚   function validate  ğŸ”’ç§æœ‰     â”‚
â”‚                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚ return { add, get } â”‚ â†çª—å£ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
    Calculator = { add, getResult }


```

### é—­åŒ…çš„â€™ç§æœ‰â€˜ ä¸ â€™å…¬å¼€â€˜
```
return å‡ºå»çš„ = å…¬å¼€
æ²¡ return çš„ = ç§æœ‰

```



|return ä»€ä¹ˆ|å…¬å¼€äº†ä»€ä¹ˆ|ç§æœ‰çš„æ˜¯ä»€ä¹ˆ|
|---|---|---|
|å‡½æ•°|ä¸€ä¸ªæ“ä½œèƒ½åŠ›|å†…éƒ¨å˜é‡|
|å¯¹è±¡|å¤šä¸ªæ“ä½œèƒ½åŠ›|å†…éƒ¨å˜é‡å’Œå‡½æ•°|
|å€¼|å€¼çš„æ‹·è´|åŸå§‹å˜é‡|
