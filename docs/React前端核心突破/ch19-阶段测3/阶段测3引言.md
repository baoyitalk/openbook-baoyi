# React é«˜é¢‘é¢è¯•çŸ¥è¯†ç‚¹ - ç¬¬ä¸€æ€§åŸç†æ·±åº¦æ‹†è§£

> æœ¬æ–‡åŸºäºé˜¶æ®µæµ‹è¯•IIIï¼Œæ¶µç›–ï¼šç”Ÿå‘½å‘¨æœŸã€äº‹ä»¶å¤„ç†ã€æ ·å¼ç®¡ç†ã€Hookã€æµ‹è¯•ã€åŸç†ã€Reduxã€Next.jsã€AntD

---

## ğŸ“‹ ç›®å½•

1. [React ç”Ÿå‘½å‘¨æœŸ](#ä¸€react-ç”Ÿå‘½å‘¨æœŸ)
2. [äº‹ä»¶å¤„ç†æœºåˆ¶](#äºŒäº‹ä»¶å¤„ç†æœºåˆ¶)
3. [CSS æ¨¡å—åŒ–](#ä¸‰css-æ¨¡å—åŒ–)
4. [é”™è¯¯è¾¹ç•Œ](#å››é”™è¯¯è¾¹ç•Œ)
5. [React Hooks](#äº”react-hooks)
6. [æµ‹è¯•ä¸ç¯å¢ƒæ¨¡æ‹Ÿ](#å…­æµ‹è¯•ä¸ç¯å¢ƒæ¨¡æ‹Ÿ)
7. [Redux ä¸‰å¤§åŸåˆ™](#ä¸ƒredux-ä¸‰å¤§åŸåˆ™)
8. [Next.js è·¯ç”±](#å…«nextjs-è·¯ç”±)
9. [æ€§èƒ½ä¼˜åŒ–ï¼šé˜»å¡æ¸²æŸ“ä¸è™šæ‹Ÿåˆ—è¡¨](#ä¹æ€§èƒ½ä¼˜åŒ–é˜»å¡æ¸²æŸ“ä¸è™šæ‹Ÿåˆ—è¡¨)
10. [Virtual DOM ä¸ Diff ç®—æ³•](#åvirtual-dom-ä¸-diff-ç®—æ³•)
11. [é€‰æ‹©é¢˜è§£æ](#åä¸€é€‰æ‹©é¢˜è§£æ)

---

## ä¸€ã€React ç”Ÿå‘½å‘¨æœŸ

### 1.1 ç¬¬ä¸€æ€§åŸç†ï¼šç»„ä»¶ä¸ºä»€ä¹ˆéœ€è¦ç”Ÿå‘½å‘¨æœŸï¼Ÿ

```
æœ¬è´¨é—®é¢˜ï¼šç»„ä»¶ä»"å‡ºç”Ÿ"åˆ°"æ­»äº¡"ï¼Œå¦‚ä½•åœ¨æ­£ç¡®çš„æ—¶æœºåšæ­£ç¡®çš„äº‹ï¼Ÿ

ç­”æ¡ˆï¼šç”Ÿå‘½å‘¨æœŸ = çŠ¶æ€å˜åŒ–çš„é’©å­å‡½æ•° = æ§åˆ¶å‰¯ä½œç”¨çš„æ—¶æœº
```

### 1.2 ä¸‰ä¸ªé˜¶æ®µé€»è¾‘å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     React ç”Ÿå‘½å‘¨æœŸä¸‰é˜¶æ®µ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚   æŒ‚è½½é˜¶æ®µ    â”‚ -> â”‚   æ›´æ–°é˜¶æ®µ    â”‚ -> â”‚   å¸è½½é˜¶æ®µ    â”‚     â”‚
â”‚   â”‚  (Mounting)  â”‚    â”‚  (Updating)  â”‚    â”‚ (Unmounting) â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                   â”‚                   â”‚               â”‚
â”‚         â–¼                   â–¼                   â–¼               â”‚
â”‚   constructor()       shouldUpdate()    componentWillUnmount() â”‚
â”‚   getDerivedState()   getDerivedState()                        â”‚
â”‚   render()            render()                                 â”‚
â”‚   componentDidMount() getSnapshotBefore()                      â”‚
â”‚                       componentDidUpdate()                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 ä¸ºä»€ä¹ˆå¼‚æ­¥è¯·æ±‚æ”¾åœ¨ componentDidMount()ï¼Ÿ

```javascript
// âŒ é”™è¯¯åšæ³•ï¼šåœ¨ constructor ä¸­è¯·æ±‚
constructor() {
  fetch('/api/data').then(data => {
    this.setState({ data }); // ç»„ä»¶å¯èƒ½è¿˜æ²¡æŒ‚è½½ï¼
  });
}

// âœ… æ­£ç¡®åšæ³•ï¼šåœ¨ componentDidMount ä¸­è¯·æ±‚
componentDidMount() {
  fetch('/api/data').then(data => {
    this.setState({ data }); // ç»„ä»¶å·²æŒ‚è½½ï¼Œå¯ä»¥å®‰å…¨æ›´æ–°
  });
}
```

**ä¸‰å¤§åŸå› ï¼š**

| åŸå›  | è§£é‡Š |
|------|------|
| **DOM å·²å°±ç»ª** | å¯ä»¥æ“ä½œçœŸå® DOM |
| **é¿å…é‡å¤è¯·æ±‚** | SSR åœºæ™¯ä¸‹åªåœ¨å®¢æˆ·ç«¯æ‰§è¡Œä¸€æ¬¡ |
| **çŠ¶æ€æ›´æ–°å®‰å…¨** | ä¿è¯ setState èƒ½æ­£å¸¸å·¥ä½œ |

---

## äºŒã€äº‹ä»¶å¤„ç†æœºåˆ¶

### 2.1 ç¬¬ä¸€æ€§åŸç†ï¼šReact ä¸ºä»€ä¹ˆè¦è‡ªå·±æä¸€å¥—äº‹ä»¶ç³»ç»Ÿï¼Ÿ

```
æœ¬è´¨é—®é¢˜ï¼šæµè§ˆå™¨åŸç”Ÿäº‹ä»¶æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ

é—®é¢˜1: å…¼å®¹æ€§å·®å¼‚ï¼ˆIE vs Chrome vs Firefoxï¼‰
é—®é¢˜2: å†…å­˜ç®¡ç†å›°éš¾ï¼ˆæ¯ä¸ªå…ƒç´ éƒ½ç»‘å®šäº‹ä»¶ = å†…å­˜æ³„æ¼é£é™©ï¼‰
é—®é¢˜3: éš¾ä»¥ç»Ÿä¸€æ§åˆ¶

React è§£å†³æ–¹æ¡ˆï¼šåˆæˆäº‹ä»¶ï¼ˆSyntheticEventï¼‰= ä»£ç† + ç»Ÿä¸€ + æ± åŒ–
```

### 2.2 React vs DOM äº‹ä»¶å¯¹æ¯”

| å¯¹æ¯”é¡¹ | React äº‹ä»¶ | DOM åŸç”Ÿäº‹ä»¶ |
|--------|-----------|-------------|
| **å‘½åæ–¹å¼** | å°é©¼å³°ï¼š`onClick` | å…¨å°å†™ï¼š`onclick` |
| **ä¼ å‚æ–¹å¼** | JSX ä¼ å‡½æ•°ï¼š`onClick={fn}` | å­—ç¬¦ä¸²ï¼š`onclick="fn()"` |
| **äº‹ä»¶å¯¹è±¡** | SyntheticEventï¼ˆåˆæˆäº‹ä»¶ï¼‰ | åŸç”Ÿ Event |
| **æ‰§è¡Œé¡ºåº** | åŸç”Ÿå…ˆæ‰§è¡Œï¼Œåˆæˆåæ‰§è¡Œ | - |

### 2.3 ç»å…¸é¢è¯•ä»£ç ï¼šäº‹ä»¶æ‰§è¡Œé¡ºåº

```javascript
import React, { useEffect, useRef } from 'react';

function EventOrderDemo() {
  const buttonRef = useRef(null);
  
  useEffect(() => {
    // åŸç”Ÿäº‹ä»¶
    buttonRef.current.addEventListener('click', () => {
      console.log('1. åŸç”Ÿäº‹ä»¶');
    });
    
    document.addEventListener('click', () => {
      console.log('3. document åŸç”Ÿäº‹ä»¶');
    });
  }, []);
  
  const handleClick = () => {
    console.log('2. React åˆæˆäº‹ä»¶');
  };
  
  return (
    <button ref={buttonRef} onClick={handleClick}>
      ç‚¹å‡»æŸ¥çœ‹æ‰§è¡Œé¡ºåº
    </button>
  );
}

// ç‚¹å‡»è¾“å‡ºé¡ºåºï¼š
// 1. åŸç”Ÿäº‹ä»¶
// 2. React åˆæˆäº‹ä»¶  
// 3. document åŸç”Ÿäº‹ä»¶
```

### 2.4 React 17 äº‹ä»¶æ”¹è¿›é€»è¾‘å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    äº‹ä»¶å§”æ‰˜ä½ç½®å˜åŒ–                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   React 16 åŠæ›´æ—©ç‰ˆæœ¬              React 17+                    â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚     document     â”‚          â”‚    Root å®¹å™¨      â”‚          â”‚
â”‚   â”‚   (äº‹ä»¶å§”æ‰˜ä½ç½®)  â”‚    =>    â”‚   (äº‹ä»¶å§”æ‰˜ä½ç½®)  â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚            â”‚                            â”‚                      â”‚
â”‚            â–¼                            â–¼                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚   #root å®¹å™¨     â”‚          â”‚   ç»„ä»¶æ ‘         â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚            â”‚                                                   â”‚
â”‚            â–¼                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          ä¼˜åŠ¿ï¼š                         â”‚
â”‚   â”‚    ç»„ä»¶æ ‘        â”‚          âœ… å¤š React ç‰ˆæœ¬å…±å­˜            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          âœ… ä¸å…¶ä»–æ¡†æ¶éš”ç¦»               â”‚
â”‚                                 âœ… æ›´å¥½çš„å¾®å‰ç«¯æ”¯æŒ              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€CSS æ¨¡å—åŒ–

### 3.1 ç¬¬ä¸€æ€§åŸç†ï¼šCSS ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–ï¼Ÿ

```
æœ¬è´¨é—®é¢˜ï¼šCSS æ˜¯å…¨å±€çš„ï¼Œå¦‚ä½•é¿å…æ ·å¼å†²çªï¼Ÿ

ä¼ ç»Ÿ CSS ç—›ç‚¹ï¼š
â”œâ”€â”€ å…¨å±€æ±¡æŸ“ï¼ˆ.btn å¯èƒ½åˆ°å¤„å†²çªï¼‰
â”œâ”€â”€ å‘½åå›°éš¾ï¼ˆ.home-page-header-title-text-boldï¼‰
â”œâ”€â”€ ä¾èµ–ä¸æ˜ç¡®ï¼ˆä¸çŸ¥é“å“ªäº›æ ·å¼åœ¨ç”¨ï¼‰
â””â”€â”€ éš¾ä»¥å¤ç”¨ï¼ˆå¤åˆ¶ç²˜è´´æ»¡å¤©é£ï¼‰

è§£å†³æ€è·¯ï¼šè®© CSS æ‹¥æœ‰"ä½œç”¨åŸŸ"
```

### 3.2 CSS æ¨¡å—åŒ–æ–¹æ¡ˆå¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CSS æ¨¡å—åŒ–æ–¹æ¡ˆæ¼”è¿›                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  BEM å‘½å   â”‚    â”‚ CSS Modules â”‚    â”‚ CSS-in-JS  â”‚        â”‚
â”‚  â”‚  çº¦å®šè§„èŒƒ   â”‚ -> â”‚  ç¼–è¯‘éš”ç¦»    â”‚ -> â”‚  è¿è¡Œæ—¶æ–¹æ¡ˆ  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚        â”‚                  â”‚                  â”‚                 â”‚
â”‚        â–¼                  â–¼                  â–¼                 â”‚
â”‚  .block__elem--mod   .xxx_hash123    styled.div`...`          â”‚
â”‚                                                                 â”‚
â”‚  ä¼˜ç‚¹ï¼šæ— ä¾èµ–        ä¼˜ç‚¹ï¼šçœŸæ­£éš”ç¦»     ä¼˜ç‚¹ï¼šåŠ¨æ€æ ·å¼            â”‚
â”‚  ç¼ºç‚¹ï¼šé äººçº¦æŸ      ç¼ºç‚¹ï¼šéœ€æ„å»ºå·¥å…·   ç¼ºç‚¹ï¼šè¿è¡Œæ—¶å¼€é”€          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 ç»å…¸é¢è¯•ä»£ç ï¼šCSS Modules ä½¿ç”¨

```javascript
// Button.module.css
.button {
  background: blue;
  color: white;
}

.primary {
  background: green;
}

// Button.jsx
import styles from './Button.module.css';

function Button({ primary, children }) {
  return (
    <button 
      className={`${styles.button} ${primary ? styles.primary : ''}`}
    >
      {children}
    </button>
  );
}

// ç¼–è¯‘åçš„ className: "Button_button_x7d2f Button_primary_k9z1"
```

### 3.4 ç»å…¸é¢è¯•ä»£ç ï¼šStyled-Components

```javascript
import styled from 'styled-components';

const Button = styled.button`
  background: ${props => props.primary ? 'green' : 'blue'};
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  
  &:hover {
    opacity: 0.8;
  }
`;

// ä½¿ç”¨
<Button primary>ä¸»è¦æŒ‰é’®</Button>
<Button>æ™®é€šæŒ‰é’®</Button>
```

---

## å››ã€é”™è¯¯è¾¹ç•Œ

### 4.1 ç¬¬ä¸€æ€§åŸç†ï¼šä¸ºä»€ä¹ˆéœ€è¦é”™è¯¯è¾¹ç•Œï¼Ÿ

```
æœ¬è´¨é—®é¢˜ï¼šä¸€ä¸ªç»„ä»¶å´©æºƒï¼Œæ•´ä¸ªåº”ç”¨éƒ½ç™½å±ï¼Ÿ

JavaScript é”™è¯¯ä¼ æ’­ï¼šå­ç»„ä»¶é”™è¯¯ -> å†’æ³¡åˆ°çˆ¶ç»„ä»¶ -> æ•´æ£µæ ‘å´©æºƒ
React è§£å†³æ–¹æ¡ˆï¼šé”™è¯¯è¾¹ç•Œ = try-catch çš„ç»„ä»¶ç‰ˆæœ¬
```

### 4.2 é”™è¯¯è¾¹ç•Œèƒ½æ•è·ä»€ä¹ˆï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é”™è¯¯è¾¹ç•Œæ•è·èŒƒå›´                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   âœ… èƒ½æ•è·                        âŒ ä¸èƒ½æ•è·                   â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚
â”‚   â€¢ å­ç»„ä»¶æ¸²æŸ“é”™è¯¯                 â€¢ äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„é”™è¯¯         â”‚
â”‚   â€¢ ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­çš„é”™è¯¯           â€¢ å¼‚æ­¥ä»£ç ï¼ˆsetTimeoutç­‰ï¼‰     â”‚
â”‚   â€¢ æ„é€ å‡½æ•°ä¸­çš„é”™è¯¯               â€¢ æœåŠ¡ç«¯æ¸²æŸ“                  â”‚
â”‚                                   â€¢ é”™è¯¯è¾¹ç•Œç»„ä»¶è‡ªèº«çš„é”™è¯¯       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 ç»å…¸é¢è¯•ä»£ç ï¼šé”™è¯¯è¾¹ç•Œå®ç°

```javascript
class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false, error: null };
  }

  // é™æ€æ–¹æ³•ï¼šæ›´æ–° stateï¼Œå±•ç¤ºé™çº§ UI
  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }

  // å®ä¾‹æ–¹æ³•ï¼šè®°å½•é”™è¯¯ä¿¡æ¯
  componentDidCatch(error, errorInfo) {
    // å‘é€åˆ°é”™è¯¯ç›‘æ§æœåŠ¡
    logErrorToService(error, errorInfo.componentStack);
  }

  render() {
    if (this.state.hasError) {
      return (
        <div className="error-fallback">
          <h2>å‡ºé”™äº†ï¼</h2>
          <details>
            <summary>é”™è¯¯è¯¦æƒ…</summary>
            <pre>{this.state.error?.toString()}</pre>
          </details>
          <button onClick={() => this.setState({ hasError: false })}>
            é‡è¯•
          </button>
        </div>
      );
    }

    return this.props.children;
  }
}

// ä½¿ç”¨
<ErrorBoundary>
  <RiskyComponent />
</ErrorBoundary>
```

### 4.4 äº‹ä»¶å¤„ç†å‡½æ•°é”™è¯¯æ•è·

```javascript
// äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„é”™è¯¯éœ€è¦ç”¨ try-catch
function MyComponent() {
  const handleClick = () => {
    try {
      // å¯èƒ½å‡ºé”™çš„ä»£ç 
      riskyOperation();
    } catch (error) {
      // æ‰‹åŠ¨å¤„ç†é”™è¯¯
      console.error('ç‚¹å‡»å¤„ç†å‡ºé”™:', error);
      showErrorNotification(error.message);
    }
  };

  return <button onClick={handleClick}>ç‚¹å‡»</button>;
}
```

---

## äº”ã€React Hooks

### 5.1 ç¬¬ä¸€æ€§åŸç†ï¼šHook è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ

```
Class ç»„ä»¶çš„ç—›ç‚¹ï¼š
â”œâ”€â”€ é€»è¾‘å¤ç”¨å›°éš¾ï¼ˆHOC åµŒå¥—åœ°ç‹±ï¼‰
â”œâ”€â”€ å¤æ‚ç»„ä»¶éš¾ä»¥ç†è§£ï¼ˆç”Ÿå‘½å‘¨æœŸåˆ†æ•£é€»è¾‘ï¼‰
â”œâ”€â”€ this æŒ‡å‘å›°æƒ‘
â””â”€â”€ éš¾ä»¥è¿›è¡Œä»£ç å‹ç¼©ä¼˜åŒ–

Hook æœ¬è´¨ï¼šè®©å‡½æ•°ç»„ä»¶æ‹¥æœ‰çŠ¶æ€å’Œå‰¯ä½œç”¨èƒ½åŠ›
```

### 5.2 æ ¸å¿ƒ Hook å¯¹æ¯”å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ ¸å¿ƒ Hook å…³ç³»å›¾                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚              â”‚         çŠ¶æ€ç®¡ç†                 â”‚                â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                    â–²              â–²                             â”‚
â”‚                    â”‚              â”‚                             â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚         â”‚  useState   â”‚    â”‚ useReducer â”‚                      â”‚
â”‚         â”‚  ç®€å•çŠ¶æ€    â”‚    â”‚  å¤æ‚çŠ¶æ€   â”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                 â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚              â”‚         å‰¯ä½œç”¨å¤„ç†               â”‚                â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                    â–²              â–²                             â”‚
â”‚                    â”‚              â”‚                             â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚         â”‚  useEffect    â”‚  â”‚ useLayoutEffect  â”‚                â”‚
â”‚         â”‚  å¼‚æ­¥æ‰§è¡Œ      â”‚  â”‚  åŒæ­¥æ‰§è¡Œ        â”‚                â”‚
â”‚         â”‚  ä¸é˜»å¡æ¸²æŸ“    â”‚  â”‚  é˜»å¡æ¸²æŸ“        â”‚                â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 useEffect ä¸¤ä¸ªå‚æ•°è¯¦è§£

```javascript
useEffect(
  // å‚æ•°1: å‰¯ä½œç”¨å‡½æ•°
  () => {
    // æ‰§è¡Œå‰¯ä½œç”¨
    const subscription = api.subscribe(id);
    
    // è¿”å›æ¸…ç†å‡½æ•°ï¼ˆå¯é€‰ï¼‰
    return () => {
      subscription.unsubscribe();
    };
  },
  // å‚æ•°2: ä¾èµ–æ•°ç»„
  [id]  // åªæœ‰ id å˜åŒ–æ—¶æ‰é‡æ–°æ‰§è¡Œ
);

// ä¾èµ–æ•°ç»„çš„ä¸‰ç§æƒ…å†µï¼š
useEffect(() => {}, []);     // ç©ºæ•°ç»„ï¼šä»…æŒ‚è½½/å¸è½½æ—¶æ‰§è¡Œ
useEffect(() => {}, [a, b]); // æœ‰ä¾èµ–ï¼šä¾èµ–å˜åŒ–æ—¶æ‰§è¡Œ
useEffect(() => {});         // æ— å‚æ•°ï¼šæ¯æ¬¡æ¸²æŸ“éƒ½æ‰§è¡Œ
```

### 5.4 useReducer vs useState ä½¿ç”¨åœºæ™¯

```javascript
// useStateï¼šç®€å•çŠ¶æ€
const [count, setCount] = useState(0);
const [name, setName] = useState('');

// useReducerï¼šå¤æ‚çŠ¶æ€é€»è¾‘
const initialState = { count: 0, step: 1 };

function reducer(state, action) {
  switch (action.type) {
    case 'increment':
      return { ...state, count: state.count + state.step };
    case 'decrement':
      return { ...state, count: state.count - state.step };
    case 'setStep':
      return { ...state, step: action.payload };
    case 'reset':
      return initialState;
    default:
      throw new Error('Unknown action');
  }
}

function Counter() {
  const [state, dispatch] = useReducer(reducer, initialState);
  
  return (
    <div>
      <p>Count: {state.count}</p>
      <button onClick={() => dispatch({ type: 'increment' })}>+</button>
      <button onClick={() => dispatch({ type: 'decrement' })}>-</button>
      <button onClick={() => dispatch({ type: 'reset' })}>é‡ç½®</button>
    </div>
  );
}
```

**ä½•æ—¶ç”¨ useReducerï¼Ÿ**

| åœºæ™¯ | æ¨è |
|------|------|
| å¤šä¸ªå­å€¼çš„å¤æ‚å¯¹è±¡ | useReducer |
| ä¸‹ä¸€ä¸ªçŠ¶æ€ä¾èµ–ä¸Šä¸€ä¸ªçŠ¶æ€ | useReducer |
| çŠ¶æ€é€»è¾‘éœ€è¦å¤ç”¨ | useReducer |
| ç®€å•ç‹¬ç«‹çš„çŠ¶æ€ | useState |

### 5.5 useLayoutEffect vs useEffect

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ‰§è¡Œæ—¶æœºå¯¹æ¯”                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ç»„ä»¶æ›´æ–° â”€â”€> DOM å˜æ›´ â”€â”€> useLayoutEffect â”€â”€> æµè§ˆå™¨ç»˜åˆ¶       â”‚
â”‚                                      â”‚                          â”‚
â”‚                              â”€â”€> useEffect                      â”‚
â”‚                                                                 â”‚
â”‚   useLayoutEffect: åŒæ­¥æ‰§è¡Œï¼Œé˜»å¡æ¸²æŸ“ï¼Œé€‚åˆ DOM æµ‹é‡å’ŒåŒæ­¥å¸ƒå±€   â”‚
â”‚   useEffect: å¼‚æ­¥æ‰§è¡Œï¼Œä¸é˜»å¡æ¸²æŸ“ï¼Œé€‚åˆæ•°æ®è·å–ã€è®¢é˜…ç­‰          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.6 è‡ªå®šä¹‰ Hook

```javascript
// è‡ªå®šä¹‰ Hookï¼šå°è£…å¯å¤ç”¨çš„çŠ¶æ€é€»è¾‘
function useWindowSize() {
  const [size, setSize] = useState({
    width: window.innerWidth,
    height: window.innerHeight,
  });

  useEffect(() => {
    const handleResize = () => {
      setSize({
        width: window.innerWidth,
        height: window.innerHeight,
      });
    };

    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);

  return size;
}

// ä½¿ç”¨
function MyComponent() {
  const { width, height } = useWindowSize();
  return <p>çª—å£å¤§å°ï¼š{width} x {height}</p>;
}
```

**è‡ªå®šä¹‰ Hook çš„ä½œç”¨ï¼š**
- æå–ç»„ä»¶é€»è¾‘ï¼Œå®ç°ä»£ç å¤ç”¨
- ä»¥ `use` å¼€å¤´å‘½åï¼Œéµå¾ª Hook è§„åˆ™
- å¯ä»¥è°ƒç”¨å…¶ä»– Hook

---

## å…­ã€æµ‹è¯•ä¸ç¯å¢ƒæ¨¡æ‹Ÿ

### 6.1 å¦‚ä½•æ¨¡æ‹Ÿ DOM ç¯å¢ƒï¼Ÿ

```javascript
// Jest + jsdom é…ç½®
// jest.config.js
module.exports = {
  testEnvironment: 'jsdom',  // æ¨¡æ‹Ÿæµè§ˆå™¨ç¯å¢ƒ
};

// ä½¿ç”¨ @testing-library/react
import { render, screen, fireEvent } from '@testing-library/react';

test('æŒ‰é’®ç‚¹å‡»æµ‹è¯•', () => {
  render(<Counter />);
  
  const button = screen.getByRole('button', { name: /increment/i });
  fireEvent.click(button);
  
  expect(screen.getByText(/count: 1/i)).toBeInTheDocument();
});
```

### 6.2 å¸¸ç”¨æ¨¡æ‹Ÿ DOM æ–¹æ¡ˆ

| æ–¹æ¡ˆ | ç‰¹ç‚¹ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| **jsdom** | çº¯ JS å®ç°çš„ DOM | Jest é»˜è®¤ï¼Œå•å…ƒæµ‹è¯• |
| **happy-dom** | æ›´å¿«çš„ jsdom æ›¿ä»£å“ | Vitest æ¨è |
| **Puppeteer** | çœŸå® Chrome æµè§ˆå™¨ | E2E æµ‹è¯• |
| **Playwright** | å¤šæµè§ˆå™¨æ”¯æŒ | è·¨æµè§ˆå™¨ E2E æµ‹è¯• |

---

## ä¸ƒã€Redux ä¸‰å¤§åŸåˆ™

### 7.1 ç¬¬ä¸€æ€§åŸç†ï¼šä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸‰ä¸ªåŸåˆ™ï¼Ÿ

```
æœ¬è´¨é—®é¢˜ï¼šå¦‚ä½•è®©çŠ¶æ€ç®¡ç†å¯é¢„æµ‹ã€å¯è¿½æº¯ã€å¯è°ƒè¯•ï¼Ÿ

ç­”æ¡ˆï¼šé€šè¿‡çº¦æŸæ¥æ¢å–ç¡®å®šæ€§
```

### 7.2 ä¸‰å¤§åŸåˆ™é€»è¾‘å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Redux ä¸‰å¤§åŸåˆ™                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 1. å•ä¸€æ•°æ®æº (Single Source of Truth)                  â”‚    â”‚
â”‚  â”‚    æ•´ä¸ªåº”ç”¨çŠ¶æ€å­˜å‚¨åœ¨ä¸€ä¸ª store çš„å¯¹è±¡æ ‘ä¸­                â”‚    â”‚
â”‚  â”‚    å¥½å¤„ï¼šçŠ¶æ€å¯é¢„æµ‹ã€æ˜“äºè°ƒè¯•ã€æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                     â”‚
â”‚                           â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 2. çŠ¶æ€åªè¯» (State is Read-Only)                        â”‚    â”‚
â”‚  â”‚    å”¯ä¸€æ”¹å˜çŠ¶æ€çš„æ–¹å¼æ˜¯è§¦å‘ action                       â”‚    â”‚
â”‚  â”‚    å¥½å¤„ï¼šé˜²æ­¢éšæ„ä¿®æ”¹ã€æ‰€æœ‰å˜åŒ–å¯è¿½æº¯                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                     â”‚
â”‚                           â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 3. çº¯å‡½æ•°ä¿®æ”¹ (Changes Made with Pure Functions)        â”‚    â”‚
â”‚  â”‚    Reducer æ˜¯çº¯å‡½æ•°ï¼š(prevState, action) => newState    â”‚    â”‚
â”‚  â”‚    å¥½å¤„ï¼šå¯æµ‹è¯•ã€å¯é¢„æµ‹ã€æ”¯æŒæ—¶é—´æ—…è¡Œè°ƒè¯•                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 ç»å…¸é¢è¯•ä»£ç ï¼šRedux å®Œæ•´ç¤ºä¾‹

```javascript
import { createStore } from 'redux';

// Action Types
const INCREMENT = 'INCREMENT';
const DECREMENT = 'DECREMENT';

// Action Creators
const increment = (amount = 1) => ({ type: INCREMENT, payload: amount });
const decrement = (amount = 1) => ({ type: DECREMENT, payload: amount });

// Reducerï¼ˆçº¯å‡½æ•°ï¼‰
const counterReducer = (state = { count: 0 }, action) => {
  switch (action.type) {
    case INCREMENT:
      return { ...state, count: state.count + action.payload };
    case DECREMENT:
      return { ...state, count: state.count - action.payload };
    default:
      return state;
  }
};

// Storeï¼ˆå•ä¸€æ•°æ®æºï¼‰
const store = createStore(counterReducer);

// è®¢é˜…çŠ¶æ€å˜åŒ–
store.subscribe(() => {
  console.log('State changed:', store.getState());
});

// é€šè¿‡ dispatch action ä¿®æ”¹çŠ¶æ€ï¼ˆçŠ¶æ€åªè¯»ï¼‰
store.dispatch(increment(5));  // { count: 5 }
store.dispatch(decrement(2));  // { count: 3 }
```

---

## å…«ã€Next.js è·¯ç”±

### 8.1 Next.js è·¯ç”±ä¼˜åŠ¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Next.js è·¯ç”±ä¼˜åŠ¿                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 1. åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„è·¯ç”±                                    â”‚  â”‚
â”‚   â”‚    pages/about.js => /about                             â”‚  â”‚
â”‚   â”‚    pages/blog/[id].js => /blog/123                      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 2. è‡ªåŠ¨ä»£ç åˆ†å‰²                                          â”‚  â”‚
â”‚   â”‚    æ¯ä¸ªé¡µé¢åªåŠ è½½æ‰€éœ€çš„ JS                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 3. å¤šç§æ¸²æŸ“æ¨¡å¼                                          â”‚  â”‚
â”‚   â”‚    SSR / SSG / ISR / CSR è‡ªç”±é€‰æ‹©                        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 4. å†…ç½®é¢„å–ä¼˜åŒ–                                          â”‚  â”‚
â”‚   â”‚    <Link> è‡ªåŠ¨é¢„å–å¯è§é“¾æ¥                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 5. API è·¯ç”±                                              â”‚  â”‚
â”‚   â”‚    pages/api/*.js è‡ªåŠ¨æˆä¸º API ç«¯ç‚¹                      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 ç»å…¸é¢è¯•ä»£ç ï¼šåŠ¨æ€è·¯ç”±

```javascript
// pages/posts/[id].js
import { useRouter } from 'next/router';

export default function Post({ post }) {
  const router = useRouter();
  
  // å¦‚æœé¡µé¢è¿˜åœ¨ç”Ÿæˆï¼Œæ˜¾ç¤º loading
  if (router.isFallback) {
    return <div>Loading...</div>;
  }
  
  return (
    <article>
      <h1>{post.title}</h1>
      <p>{post.content}</p>
    </article>
  );
}

// é™æ€ç”Ÿæˆè·¯å¾„
export async function getStaticPaths() {
  const posts = await fetchAllPosts();
  
  return {
    paths: posts.map(post => ({
      params: { id: post.id.toString() }
    })),
    fallback: true, // æ–°è·¯å¾„æŒ‰éœ€ç”Ÿæˆ
  };
}

// é™æ€ç”Ÿæˆæ•°æ®
export async function getStaticProps({ params }) {
  const post = await fetchPost(params.id);
  
  return {
    props: { post },
    revalidate: 60, // ISR: 60ç§’åé‡æ–°ç”Ÿæˆ
  };
}
```

---

## ä¹ã€æ€§èƒ½ä¼˜åŒ–ï¼šé˜»å¡æ¸²æŸ“ä¸è™šæ‹Ÿåˆ—è¡¨

### 9.1 ä»€ä¹ˆæ˜¯é˜»å¡æ¸²æŸ“ï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é˜»å¡æ¸²æŸ“                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   é˜»å¡æ¸²æŸ“ï¼šæµè§ˆå™¨åœ¨è§£æåˆ°æŸäº›èµ„æºæ—¶ï¼Œä¼šæš‚åœé¡µé¢æ¸²æŸ“ï¼Œç­‰å¾…èµ„æº   â”‚
â”‚            åŠ è½½å’Œæ‰§è¡Œå®Œæˆåæ‰ç»§ç»­                               â”‚
â”‚                                                                 â”‚
â”‚   å¸¸è§é˜»å¡èµ„æºï¼š                                                â”‚
â”‚   â€¢ <script> æ ‡ç­¾ï¼ˆæ—  async/deferï¼‰                             â”‚
â”‚   â€¢ <link rel="stylesheet">                                    â”‚
â”‚   â€¢ åŒæ­¥çš„ JavaScript æ‰§è¡Œ                                      â”‚
â”‚                                                                 â”‚
â”‚   è§£å†³æ–¹æ¡ˆï¼š                                                    â”‚
â”‚   â€¢ ä½¿ç”¨ async / defer å±æ€§                                     â”‚
â”‚   â€¢ CSS å†…è”å…³é”®æ ·å¼                                            â”‚
â”‚   â€¢ ä»£ç åˆ†å‰² (Code Splitting)                                   â”‚
â”‚   â€¢ ä½¿ç”¨ React.lazy + Suspense                                  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 AntD è™šæ‹Ÿåˆ—è¡¨å®ç°åŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è™šæ‹Ÿåˆ—è¡¨æ ¸å¿ƒåŸç†                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   é—®é¢˜ï¼š10000 æ¡æ•°æ®ï¼Œåˆ›å»º 10000 ä¸ª DOM èŠ‚ç‚¹ => é¡µé¢å¡é¡¿        â”‚
â”‚                                                                 â”‚
â”‚   è§£å†³ï¼šåªæ¸²æŸ“å¯è§†åŒºåŸŸå†…çš„å…ƒç´ ï¼ˆé€šå¸¸ 10-20 ä¸ªï¼‰                  â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚   â”‚         è™šæ‹Ÿåˆ—è¡¨ç»“æ„                â”‚                       â”‚
â”‚   â”‚                                    â”‚                       â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                       â”‚
â”‚   â”‚   â”‚     ä¸Šæ–¹å ä½åŒºåŸŸ         â”‚    â”‚  paddingTop           â”‚
â”‚   â”‚   â”‚     (ä¸æ¸²æŸ“)             â”‚    â”‚                       â”‚
â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚                       â”‚
â”‚   â”‚   â”‚     å¯è§†åŒºåŸŸ             â”‚    â”‚  å®é™…æ¸²æŸ“çš„            â”‚
â”‚   â”‚   â”‚     Item 5               â”‚    â”‚  DOM å…ƒç´              â”‚
â”‚   â”‚   â”‚     Item 6               â”‚    â”‚                       â”‚
â”‚   â”‚   â”‚     Item 7               â”‚    â”‚                       â”‚
â”‚   â”‚   â”‚     Item 8               â”‚    â”‚                       â”‚
â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚                       â”‚
â”‚   â”‚   â”‚     ä¸‹æ–¹å ä½åŒºåŸŸ         â”‚    â”‚  paddingBottom        â”‚
â”‚   â”‚   â”‚     (ä¸æ¸²æŸ“)             â”‚    â”‚                       â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.3 ç»å…¸é¢è¯•ä»£ç ï¼šç®€æ˜“è™šæ‹Ÿåˆ—è¡¨

```javascript
import React, { useState, useRef, useCallback } from 'react';

function VirtualList({ 
  items,           // æ‰€æœ‰æ•°æ®
  itemHeight = 50, // æ¯é¡¹é«˜åº¦
  containerHeight = 400, // å®¹å™¨é«˜åº¦
}) {
  const [scrollTop, setScrollTop] = useState(0);
  const containerRef = useRef(null);
  
  // è®¡ç®—å¯è§†èŒƒå›´
  const startIndex = Math.floor(scrollTop / itemHeight);
  const endIndex = Math.min(
    startIndex + Math.ceil(containerHeight / itemHeight) + 1,
    items.length
  );
  
  // åªæ¸²æŸ“å¯è§†èŒƒå›´å†…çš„é¡¹
  const visibleItems = items.slice(startIndex, endIndex);
  
  // æ€»é«˜åº¦ï¼ˆæ’‘å¼€æ»šåŠ¨æ¡ï¼‰
  const totalHeight = items.length * itemHeight;
  
  // å¯è§†åŒºåŸŸåç§»é‡
  const offsetY = startIndex * itemHeight;
  
  const handleScroll = useCallback((e) => {
    setScrollTop(e.target.scrollTop);
  }, []);
  
  return (
    <div
      ref={containerRef}
      style={{ 
        height: containerHeight, 
        overflow: 'auto',
        position: 'relative'
      }}
      onScroll={handleScroll}
    >
      {/* å ä½å…ƒç´ ï¼Œæ’‘å¼€æ€»é«˜åº¦ */}
      <div style={{ height: totalHeight }}>
        {/* å®é™…æ¸²æŸ“çš„åˆ—è¡¨ */}
        <div style={{ transform: `translateY(${offsetY}px)` }}>
          {visibleItems.map((item, index) => (
            <div
              key={startIndex + index}
              style={{ height: itemHeight }}
            >
              {item.content}
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

// ä½¿ç”¨
const data = Array.from({ length: 10000 }, (_, i) => ({
  id: i,
  content: `Item ${i}`
}));

<VirtualList items={data} />
```

---

## åã€Virtual DOM ä¸ Diff ç®—æ³•

### 10.1 ç¬¬ä¸€æ€§åŸç†ï¼šä¸ºä»€ä¹ˆéœ€è¦ Virtual DOMï¼Ÿ

```
æœ¬è´¨é—®é¢˜ï¼šDOM æ“ä½œå¾ˆæ…¢ï¼Œå¦‚ä½•å‡å°‘ DOM æ“ä½œï¼Ÿ

ç›´æ¥æ“ä½œ DOM çš„é—®é¢˜ï¼š
â”œâ”€â”€ æ¯æ¬¡ä¿®æ”¹éƒ½è§¦å‘é‡æ’é‡ç»˜
â”œâ”€â”€ æµè§ˆå™¨éœ€è¦é‡æ–°è®¡ç®—å¸ƒå±€
â””â”€â”€ æ€§èƒ½å¼€é”€å·¨å¤§

Virtual DOM è§£å†³æ–¹æ¡ˆï¼š
â”œâ”€â”€ ç”¨ JS å¯¹è±¡æè¿° UI ç»“æ„
â”œâ”€â”€ å…ˆåœ¨å†…å­˜ä¸­è®¡ç®—å·®å¼‚ (Diff)
â””â”€â”€ æœ€å°åŒ– DOM æ“ä½œ (Patch)
```

### 10.2 Virtual DOM å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Virtual DOM å·¥ä½œæµç¨‹                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   çŠ¶æ€å˜åŒ–                                                       â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚   â”‚  åˆ›å»ºæ–° Virtual   â”‚                                         â”‚
â”‚   â”‚     DOM æ ‘        â”‚                                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚   â”‚   Diff ç®—æ³•å¯¹æ¯”   â”‚  æ—¶é—´å¤æ‚åº¦: O(n)                        â”‚
â”‚   â”‚   æ–°æ—§ VDOM å·®å¼‚  â”‚  (ä¼ ç»Ÿæ ‘ Diff æ˜¯ O(nÂ³))                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚   â”‚   ç”Ÿæˆè¡¥ä¸ Patch  â”‚                                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚   â”‚  æœ€å°åŒ–æ›´æ–° DOM   â”‚                                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.3 Diff ç®—æ³•ä¸‰å¤§ç­–ç•¥

```javascript
// ç­–ç•¥1: åŒå±‚æ¯”è¾ƒ
// åªæ¯”è¾ƒåŒä¸€å±‚çº§çš„èŠ‚ç‚¹ï¼Œä¸è·¨å±‚çº§æ¯”è¾ƒ

// ç­–ç•¥2: ç±»å‹æ¯”è¾ƒ  
// ä¸åŒç±»å‹çš„å…ƒç´ ä¼šäº§ç”Ÿä¸åŒçš„æ ‘
// <div> å˜æˆ <span> => ç›´æ¥é”€æ¯é‡å»º

// ç­–ç•¥3: key ä¼˜åŒ–åˆ—è¡¨ Diff
// key å¸®åŠ© React è¯†åˆ«å“ªäº›å…ƒç´ æ”¹å˜äº†

// âŒ é”™è¯¯ï¼šä½¿ç”¨ index ä½œä¸º key
{items.map((item, index) => (
  <Item key={index} data={item} />  // é¡ºåºå˜åŒ–æ—¶ä¼šå‡ºé—®é¢˜
))}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨å”¯ä¸€æ ‡è¯†ä½œä¸º key
{items.map(item => (
  <Item key={item.id} data={item} />  // ç¨³å®šçš„å”¯ä¸€æ ‡è¯†
))}
```

### 10.4 React Fiber æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    React Fiber è¦ç‚¹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Fiber æ˜¯ä»€ä¹ˆï¼Ÿ                                                â”‚
â”‚   â€¢ React çš„åè°ƒå¼•æ“ï¼ˆReconcilerï¼‰                              â”‚
â”‚   â€¢ ä½¿ Virtual DOM å¯ä»¥å¢é‡å¼æ¸²æŸ“                               â”‚
â”‚   â€¢ fiber å†…éƒ¨å¯¹è±¡å­˜æ”¾ç»„ä»¶æ ‘çš„é™„åŠ ä¿¡æ¯                          â”‚
â”‚                                                                 â”‚
â”‚   Fiber è§£å†³çš„é—®é¢˜ï¼š                                            â”‚
â”‚   â€¢ æ—§æ¶æ„ï¼šåŒæ­¥æ¸²æŸ“ï¼Œå¤§ä»»åŠ¡é˜»å¡ä¸»çº¿ç¨‹                          â”‚
â”‚   â€¢ æ–°æ¶æ„ï¼šå¯ä¸­æ–­æ¸²æŸ“ï¼Œæ”¯æŒä¼˜å…ˆçº§è°ƒåº¦                          â”‚
â”‚                                                                 â”‚
â”‚   ä»»åŠ¡æ‰¹å¤„ç†ï¼š                                                   â”‚
â”‚   â€¢ React ä¼šå°†åŒç­‰ä¼˜å…ˆçº§çš„æ›´æ–°æ”¶æ•›åˆ°ä¸€æ¬¡ä»»åŠ¡ä¸­                  â”‚
â”‚   â€¢ æ¡ä»¶ï¼šåè€…ä¼˜å…ˆçº§ >= å‰è€…ä¼˜å…ˆçº§æ—¶åˆå¹¶                        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åä¸€ã€é€‰æ‹©é¢˜è§£æ

### é¢˜ç›® 1ï¼šä»¥ä¸‹å“ªä¸ªé˜¶æ®µå¯ä»¥è¯»å– DOMï¼Ÿ

```
é€‰é¡¹ï¼šA. Render é˜¶æ®µ  B. Pre-commit é˜¶æ®µ  C. Commit é˜¶æ®µ

ç­”æ¡ˆï¼šC. Commit é˜¶æ®µ

è§£æï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Render é˜¶æ®µ    â”‚  è®¡ç®—å˜åŒ–ï¼Œåˆ›å»º Fiber èŠ‚ç‚¹ï¼Œä¸èƒ½è®¿é—® DOM      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Pre-commit     â”‚  å¯ä»¥è¯»å– DOMï¼ˆgetSnapshotBeforeUpdateï¼‰      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Commit é˜¶æ®µ    â”‚  DOM å·²æ›´æ–°ï¼Œå¯ä»¥å®‰å…¨è¯»å–å’Œæ“ä½œ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é¢˜ç›® 2ï¼šä»¥ä¸‹å“ªä¸ªä¸æ˜¯ React Hook è§£å†³çš„é—®é¢˜ï¼Ÿ

```
é€‰é¡¹ï¼š
A. æé«˜ç»„ä»¶å¤ç”¨
B. ç®€åŒ–ç»„ä»¶  
C. æœ‰é™çš„æ˜¯å¦æ¸²æŸ“æ§åˆ¶
D. å‡½æ•°ç»„ä»¶ä»£æ›¿ç±»ç»„ä»¶

ç­”æ¡ˆï¼šC. æœ‰é™çš„æ˜¯å¦æ¸²æŸ“æ§åˆ¶

è§£æï¼šHook è§£å†³çš„ä¸»è¦é—®é¢˜æ˜¯é€»è¾‘å¤ç”¨ã€ç®€åŒ–ç»„ä»¶ã€é¿å… class çš„é—®é¢˜ã€‚
æ¸²æŸ“æ§åˆ¶å¯ä»¥é€šè¿‡ React.memoã€useMemo å®ç°ï¼Œä½†è¿™ä¸æ˜¯ Hook çš„æ ¸å¿ƒç›®æ ‡ã€‚
```

### é¢˜ç›® 3ï¼šäº‹ä»¶æ‰§è¡Œé¡ºåº

```
é€‰é¡¹ï¼š
A. åŸç”Ÿäº‹ä»¶å…ˆæ‰§è¡Œï¼Œåˆæˆäº‹ä»¶åæ‰§è¡Œ
B. åˆæˆäº‹ä»¶å…ˆæ‰§è¡Œï¼ŒåŸç”Ÿäº‹ä»¶åæ‰§è¡Œ
C. åŒæ—¶æ‰§è¡Œ

ç­”æ¡ˆï¼šA. åŸç”Ÿäº‹ä»¶å…ˆæ‰§è¡Œï¼Œåˆæˆäº‹ä»¶åæ‰§è¡Œ

è§£æï¼šäº‹ä»¶ä¼ æ’­é¡ºåºæ˜¯ æ•è· -> ç›®æ ‡ -> å†’æ³¡ã€‚
åŸç”Ÿäº‹ä»¶åœ¨ç›®æ ‡å…ƒç´ è§¦å‘ï¼ŒReact åˆæˆäº‹ä»¶åœ¨ root å®¹å™¨è§¦å‘ï¼ˆå†’æ³¡é˜¶æ®µï¼‰ã€‚
```

### é¢˜ç›® 4ï¼šåˆæˆäº‹ä»¶å†’æ³¡ç»‘å®šåˆ° document ä¸Šçš„ç‰ˆæœ¬ï¼Ÿ

```
é€‰é¡¹ï¼šA. React 17  B. React 17 åŠæ›´æ—©ç‰ˆæœ¬  C. React 16 åŠæ›´æ—©ç‰ˆæœ¬

ç­”æ¡ˆï¼šC. React 16 åŠæ›´æ—©ç‰ˆæœ¬

è§£æï¼šReact 17 å°†äº‹ä»¶å§”æ‰˜ä» document æ”¹ä¸º root å®¹å™¨ã€‚
```

### é¢˜ç›® 5ï¼šVirtual DOM ä½œç”¨

```
ä»¥ä¸‹å“ªä¸ªä¸æ˜¯ Virtual DOM åœ¨ React ä¸­çš„ä½œç”¨ï¼Ÿ

A. é€šå¸¸ä¸ React å…ƒç´ å…³è”ï¼Œä»£è¡¨ç”¨æˆ·ç•Œé¢çš„å¯¹è±¡
B. å‘Šè¯‰ React å¸Œæœ›è®© UI æ˜¯ä»€ä¹ˆçŠ¶æ€
C. React Fiber æ˜¯åè°ƒå¼•æ“ï¼Œä¸»è¦ç›®çš„æ˜¯ä½¿ Virtual DOM å¯ä»¥å¢é‡å¼æ¸²æŸ“
D. fibers å†…éƒ¨å¯¹è±¡æ¥å­˜æ”¾ç»„ä»¶æ ‘çš„é™„åŠ ä¿¡æ¯

ç­”æ¡ˆï¼šD

è§£æï¼šFiber æ˜¯ React çš„å†…éƒ¨å®ç°ï¼Œå®ƒå­˜æ”¾çš„æ˜¯åè°ƒè¿‡ç¨‹ä¸­çš„çŠ¶æ€ä¿¡æ¯ï¼Œ
è€Œä¸æ˜¯"å­˜æ”¾ç»„ä»¶æ ‘çš„é™„åŠ ä¿¡æ¯"è¿™ç§è¯´æ³•ä¸å‡†ç¡®ã€‚
```

### é¢˜ç›® 6ï¼šDiff è™šæ‹Ÿ DOM çš„å¤æ‚åº¦

```
é€‰é¡¹ï¼šA. O(n)  B. O(nÂ²)  C. O(nÂ³)

ç­”æ¡ˆï¼šA. O(n)

è§£æï¼šReact é€šè¿‡ä¸‰ä¸ªç­–ç•¥å°† O(nÂ³) ä¼˜åŒ–åˆ° O(n)ï¼š
1. åŒå±‚æ¯”è¾ƒ
2. ç±»å‹ä¸åŒç›´æ¥æ›¿æ¢
3. key æ ‡è¯†åˆ—è¡¨é¡¹
```

### é¢˜ç›® 7ï¼šReact æ‰¹å¤„ç†æ¡ä»¶

```
ä»€ä¹ˆæƒ…å†µä¸‹ React ä¼šå°†åŒç­‰ä¼˜å…ˆçº§çš„æ›´æ–°æ”¶æ•›åˆ°ä¸€æ¬¡ä»»åŠ¡ä¸­ï¼Ÿ

A. åè€… > å‰è€…
B. åè€… = å‰è€…  
C. åè€… < å‰è€…

ç­”æ¡ˆï¼šB. åè€… = å‰è€…ï¼ˆæˆ–åè€… >= å‰è€…ï¼‰

è§£æï¼šReact 18 çš„è‡ªåŠ¨æ‰¹å¤„ç†ä¼šåˆå¹¶åŒä¸€äº‹ä»¶å¾ªç¯ä¸­çš„å¤šæ¬¡çŠ¶æ€æ›´æ–°ã€‚
åªæœ‰ä¼˜å…ˆçº§ç›¸åŒæˆ–æ›´é«˜æ—¶æ‰ä¼šåˆå¹¶ã€‚
```

---

## ğŸ¯ æ ¸å¿ƒå¥¥ä¹‰ï¼ˆä¸€å¥è¯æ€»ç»“ï¼‰

> **React çš„æœ¬è´¨æ˜¯ã€Œç”¨å£°æ˜å¼æè¿° UIï¼Œç”¨æœ€å°ä»£ä»·æ›´æ–° DOMã€â€”â€”ç†è§£äº†ç”Ÿå‘½å‘¨æœŸæ˜¯çŠ¶æ€å˜åŒ–çš„é’©å­ã€äº‹ä»¶ç³»ç»Ÿæ˜¯è·¨æµè§ˆå™¨çš„æŠ½è±¡å±‚ã€Hook æ˜¯é€»è¾‘å¤ç”¨çš„è§£å†³æ–¹æ¡ˆã€Virtual DOM æ˜¯æ€§èƒ½ä¼˜åŒ–çš„ä¸­é—´å±‚ï¼Œä½ å°±æŒæ¡äº† React çš„ç¬¬ä¸€æ€§åŸç†ã€‚**

---

## ğŸ“š é€ŸæŸ¥è¡¨

| çŸ¥è¯†ç‚¹ | æ ¸å¿ƒè¦ç‚¹ | é¢è¯•é«˜é¢‘é—®æ³• |
|--------|----------|-------------|
| ç”Ÿå‘½å‘¨æœŸ | æŒ‚è½½â†’æ›´æ–°â†’å¸è½½ | componentDidMount ä¸ºä»€ä¹ˆæ”¾è¯·æ±‚ï¼Ÿ |
| äº‹ä»¶ç³»ç»Ÿ | åˆæˆäº‹ä»¶+äº‹ä»¶å§”æ‰˜ | React 17 äº‹ä»¶æœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ |
| CSS æ¨¡å—åŒ– | CSS Modules / CSS-in-JS | è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿæ–¹æ¡ˆå¯¹æ¯”ï¼Ÿ |
| é”™è¯¯è¾¹ç•Œ | getDerivedStateFromError | èƒ½æ•è·å“ªäº›é”™è¯¯ï¼Ÿ |
| useEffect | å‰¯ä½œç”¨+ä¾èµ–æ•°ç»„ | ç¬¬äºŒä¸ªå‚æ•°çš„ä½œç”¨ï¼Ÿ |
| useReducer | å¤æ‚çŠ¶æ€ç®¡ç† | å’Œ useState åŒºåˆ«ï¼Ÿ |
| Redux | å•ä¸€æ•°æ®æº+åªè¯»+çº¯å‡½æ•° | ä¸‰å¤§åŸåˆ™æ˜¯ä»€ä¹ˆï¼Ÿ |
| Virtual DOM | JS å¯¹è±¡+Diff+æœ€å°æ›´æ–° | Diff å¤æ‚åº¦ï¼Ÿä¸ºä»€ä¹ˆæ˜¯ O(n)ï¼Ÿ |
| è™šæ‹Ÿåˆ—è¡¨ | åªæ¸²æŸ“å¯è§†åŒºåŸŸ | 10000 æ¡æ•°æ®å¦‚ä½•ä¼˜åŒ–ï¼Ÿ |

---


ç°åœ¨æˆ‘å¼€å§‹ä¸ºæ‚¨æ•´ç†è¿™ä»½ React é˜¶æ®µæµ‹è¯•çš„å®Œæ•´çŸ¥è¯†æ€»ç»“ã€‚æˆ‘å·²ç»åŸºäºæ‚¨æä¾›çš„é˜¶æ®µæµ‹è¯•èµ„æ–™ï¼Œä½¿ç”¨ç¬¬ä¸€æ€§åŸç†å®Œæˆäº†æ·±åº¦æ‹†è§£å’Œæ€»ç»“ã€‚æ–‡æ¡£åŒ…å«ï¼š

**ğŸ“‹ æ¶µç›–å†…å®¹ï¼š**
- React ç”Ÿå‘½å‘¨æœŸä¸‰é˜¶æ®µè¯¦è§£
- äº‹ä»¶å¤„ç†æœºåˆ¶ï¼ˆå« React 17 å˜åŒ–ï¼‰
- CSS æ¨¡å—åŒ–æ–¹æ¡ˆå¯¹æ¯”
- é”™è¯¯è¾¹ç•ŒåŸç†ä¸å®ç°
- 5 å¤§æ ¸å¿ƒ Hook æ·±åº¦è§£æ
- Redux ä¸‰å¤§åŸåˆ™
- Next.js è·¯ç”±ä¼˜åŠ¿
- é˜»å¡æ¸²æŸ“ä¸è™šæ‹Ÿåˆ—è¡¨å®ç°
- Virtual DOM ä¸ Diff ç®—æ³•
- å…¨éƒ¨é€‰æ‹©é¢˜ç­”æ¡ˆè§£æ

**âœ¨ ç‰¹è‰²ï¼š**
- æ¯ä¸ªçŸ¥è¯†ç‚¹éƒ½ä»ã€Œæœ¬è´¨é—®é¢˜ã€å‡ºå‘
- é…æœ‰ ASCII é€»è¾‘å›¾è¾…åŠ©ç†è§£
- é™„å¸¦ç»å…¸é¢è¯•ä»£ç å¯ç›´æ¥ä½¿ç”¨
- æœ«å°¾é€ŸæŸ¥è¡¨æ–¹ä¾¿å¤ä¹ 

*æœ€åæ›´æ–°ï¼šåŸºäº React 18 çŸ¥è¯†ä½“ç³»æ•´ç†*

